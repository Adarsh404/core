<link rel="stylesheet" type="text/css" media="screen" href="css/wizardBg.css">
<style>
    /*custom font*/
    @import url(http://fonts.googleapis.com/css?family=Montserrat);

    /*form styles*/
    form {
        margin: 10px auto;
        position: relative;
    }

    /*Hide all except first fieldset*/
    form:not(:first-of-type) {
        display: none;
    }

    /*buttons*/
    form .action-button {
        width: 100px;
        background: #27AE60;
        font-weight: bold;
        color: white;
        border: 0 none;
        border-radius: 1px;
        cursor: pointer;
        padding: 10px 5px;
        margin: 10px 5px;
    }
    form .action-button:hover, #msform .action-button:focus {
        box-shadow: 0 0 0 2px white, 0 0 0 3px #27AE60;
    }
    /*headings*/
    .fs-title {
        font-size: 15px;
        text-transform: uppercase;
        color: #2C3E50;
        margin-bottom: 10px;
    }
    .fs-subtitle {
        font-weight: normal;
        font-size: 13px;
        color: #666;
        margin-bottom: 20px;
    }
    /*progressbar*/
    #progressbar {
        overflow: hidden;
        text-align: center;
        /*CSS counters to number the steps*/
        counter-reset: step;
        margin-top: 5px;
    }
    #progressbar li {
        list-style-type: none;
        font-size: 15px;
        width: 25%;
        float: left;
        position: relative;
    }
    #progressbar li:before {
        content: counter(step);
        counter-increment: step;
        width: 20px;
        line-height: 20px;
        display: block;
        font-size: 10px;
        color: #fff;
        background: #7d7676;
        border-radius: 3px;
        margin: 0 auto 5px auto;
    }
    /*progressbar connectors*/
    #progressbar li:after {
        content: '';
        width: 100%;
        height: 2px;
        background: #7d7676;
        position: absolute;
        left: -50%;
        top: 9px;
        z-index: -1; /*put it behind the numbers*/
    }
    #progressbar li:first-child:after {
        /*connector not needed before the first step*/
        content: none;
    }
    /*marking active/completed steps green*/
    /*The number of the step and the connector before it = green*/
    #progressbar li.active:before,  #progressbar li.active:after{
        background: #27AE60;
        color: white;
    }

    .content {
        margin:0 auto;
        padding: 10px;
    }
    a, a:hover {
        color:#7d7676;
        text-decoration: none;
    }
</style>
<!-- multistep form -->

<!-- progressbar -->
<!-- progressbar -->
<div class="wizardFlow">
</div>
<!-- fieldsets -->
<div class="content">
   <form action="" id="myForm101">
      <div class="widget-box">
         <div class="widget-header">
            <h4 class="widget-margin" style="color:black;">Nexus Configuration Management</h4>
         </div>
         <div class="widget-body">
            <div class="widget-main" style="min-height:200px">
               <div class="jarviswidget" data-widget-editbutton="false" data-widget-custombutton="false">
                  <div>
                                 <!-- widget content -->
                                 <div class="widget-body no-padding">
                                    <div class="col-lg-6 col-md-6">
                                       <label for="">Nexus Server Name:<span class="control-label redSpan">&nbsp;*</span></label>
                                       <div class="input-groups">
                                          <input name="" value="" id="nexusservername" class="required form-control" type="text"  cdata="catalyst" unique="true"  cat-validation="required,max15">
                                       </div>
                                    </div>
                                    <div class="col-lg-6 col-md-6">
                                       <label for="">User Name:<span class="control-label redSpan">&nbsp;*</span></label>
                                       <div class="input-groups">
                                          <input autocomplete="false" name="username" id="username" class="form-control" cdata="catalyst" type="text">
                                       </div>
                                    </div>
                                    <div class="col-lg-6 col-md-6 appNameLabel">
                                       <label for="name">Password:<span class="control-label redSpan">&nbsp;*</span></label>
                                       <div class="input-groups">
                                          <input name="nexuspassword" id="nexuspassword" class="form-control" type="text" cdata="catalyst"  cat-validation="required,max15">
                                       </div>
                                    </div>
                                    <div class="col-lg-6 col-md-6 appNameLabel">
                                       <label for="link">Nexus Server URL:<span class="control-label redSpan">&nbsp;*</span></label>
                                       <div class="input-groups">
                                          <input type="text" unique="true" name="hostname" id="hostname" class="form-control" type="text"  cdata="catalyst"  cat-validation="required" type="url">
                                       </div>
                                    </div>
                                    <div class="col-lg-6 col-md-6 appNameLabel">
                                       <label for="name">Organization:<span class="control-label redSpan">&nbsp;*</span></label>
                                          <select id="orgname" name="orgname" unique="true" class="form-control chooseOrganization width-100" sourcepath="1" datapath="masterjson.rows.row" valuelinkfield="costcode" style="vertical-align:central"  cdata="catalyst">
                                             <option value="">Select an Organization</option>
                                          </select>
                                    </div>
                                    <div class="col-lg-6 col-md-6">
                                       <a style="cursor:pointer;" data-toggle="modal" data-backdrop="  false" id="nexusGroupAnchorDetails" href="#nexusGroupDetailsModal"> <img title="Add Nexus Group Details" data-placement="top" rel="tooltip" style="float:right;margin-top:20px;" src="img/add.png"></a>
                                       <label style="float:left;margin-top:20px;">Nexus Group ID Details :</label>
                                       <div class="table-responsive table-div">
                                          <table id="tablenexusGroupDetails" class="table table-striped table-bordered table-hover dataTable" style="border:1px solid #eeeeee !important; text-align:center;font-size:12px;margin-top:45px;" width="100%" cellpadding="5px">
                                             <thead>
                                                <tr class="rowCustomStyle" style="font-weight:bold;">
                                                   <td style="color:#fff;background-color: #2c3742;">Name</td>
                                                   <td style="color:#fff;background-color: #2c3742; width:40%">Action</td>
                                                </tr>
                                             </thead>
                                             <tbody id="nexusGroupTbody">
                                             </tbody>
                                          </table>
                                       </div>
                                    </div>
                                    <div class="col-lg-6 col-md-6" style="margin-top:25px; display:none">
                                       <label for="name">Nexus Group ID Details:</label>
                                       <input autofocus name="ctl00$MainContent$orgname" value="" id="groupid" class="form-control" type="text"  cdata="catalyst">
                                    </div>
                                 </div>
                              </div>
               </div>
            </div>
         </div>
      </div>
      <div class="btn-group pull-right">
         <button  name="nextChef" id="savecreateNexusServerBtn" class="nextChef action-button" value="Next">Next</button>
      </div>
   </form>
</div>
<script>
    orgNameForSetup = $('#orgDropdown option:selected').attr('rowid');
    orgIdForSetup = $('#orgDropdown option:selected').val();
    var $option = $('<option></option>').val(orgNameForSetup).attr('rowid',orgIdForSetup).html(orgNameForSetup);
    $('#orgname').append($option);
    var devopsRolesWizard = $('<ol class="bwizard-steps clearfix clickable"><li aria-selected="true" class="btn-2 nexusCreate active" id="nexusCreate" style="z-index: 4;"><span class="label badge-inverse">1</span><a href="ajax/Settings/devopsRolesWizard.html" class="hidden-phone">Nexus Configuration</a><a href="ajax/Settings/devopsRolesWizard.html" class="hidden-phone"></a><a href="ajax/Settings/devopsRolesWizard.html" class="hidden-phone"></a></li><li aria-selected="true" style="z-index: 3;" id="dockerCreate" class="btn-3 dockerCreate"><span class="label">2</span><a href="ajax/Settings/dockerWizard.html" class="hidden-phone">Docker Configuration</a><a href="ajax/Settings/dockerWizard.html" class="hidden-phone"></a><a href="ajax/Settings/dockerWizard.html" class="hidden-phone"></a></li><li aria-selected="true" style="z-index: 2;" id="jenkinsCreate" class="btn-4 jenkinsCreate"><span class="label btn-1">3</span><a href="ajax/Settings/jenkinsWizard.html" class="hidden-phone">Jenkins Configuration</a><a href="ajax/Settings/jenkinsWizard.html" class="hidden-phone"></a><a href="ajax/Settings/jenkinsWizard.html" class="hidden-phone"></a></li></ol>');
    $('.wizardFlow').append(devopsRolesWizard);
    $('.btn-2 a').click(function(e) {
        e.preventDefault();
        $('.contentSetting').load(this.getAttribute('href'));
    });
    $('.btn-3 a').click(function(e) {
        $('.btn-2 a,.btn-4 a').parent('.bwizard-steps li').removeClass('active');
        $(this).parent('.bwizard-steps li').addClass('active');
        e.preventDefault();
        $('.content').load(this.getAttribute('href'));
    });
    $('.btn-4 a').click(function(e) {
        $('.btn-2 a,.btn-3 a').parent('.bwizard-steps li').removeClass('active');
        $(this).parent('.bwizard-steps li').addClass('active');
        e.preventDefault();
        $('.content').load(this.getAttribute('href'));
    });

    $(document).ready(function(e){
        $('#wizardActionListLoader').show();
        //api call for getting the status of wizard
        $.get('/setting-wizard/org/' + orgIdForSetup, function(data) {
             if (data.currentStep.nestedSteps) {
                            var nestedSteps = data.currentStep.nestedSteps;
                            if (nestedSteps[0].name === 'Nexus' && nestedSteps[0].isCompleted === true &&
                                nestedSteps[1].name === 'Docker' && nestedSteps[1].isCompleted === false &&
                                nestedSteps[2].name === 'Jenkins' && nestedSteps[2].isCompleted === false) {
                                $('.btn-2 a').parent('.bwizard-steps li').removeClass('active').addClass('green-btn');
                      $('.contentSetting').find('ol li#dockerCreate').addClass('active');
                      $('.content').load('ajax/Settings/dockerWizard.html');
                            } else if (nestedSteps[0].name === 'Nexus' && nestedSteps[0].isCompleted === true &&
                                nestedSteps[1].name === 'Docker' && nestedSteps[1].isCompleted === true &&
                                nestedSteps[2].name === 'Jenkins' && nestedSteps[2].isCompleted === false) {
                                $('.btn-2 a').parent('.bwizard-steps li').removeClass('active').addClass('green-btn');
            $('.contentSetting').find('ol li#dockerCreate').removeClass('active').addClass('green-btn');
            $('.contentSetting').find('ol li#jenkinsCreate').addClass('active');
            $('.content').load('ajax/Settings/jenkinsWizard.html');
                            } else {
                                
                            }
                        }
        });
        $('#wizardActionListLoader').hide();

    });

   $('#nexusGroupAnchorDetails').click(function(e) {
     $("#nexusGroupDetailsModal").modal('show');
     $('#nexusGroupDetailsCreate').trigger("reset");
   });
   $("#saveNexusGroupDetails").click(function(e) {
     e.preventDefault();
     var nexusGroupName = $("#nexusGroupId").val();
     if (nexusGroupName == '') {
       alert("Please enter Nexus GroupId");
     }
     if (nexusGroupName != '') {
       var $nexusGroupTbody = $('#nexusGroupTbody');
       var $tr = $('<tr class="nexusGroupDetailsRow"></tr>');
       var $tdnexusGroupName = $('<td class="tdnexusGroupName" value=' + nexusGroupName + ' style="word-break: break-word;"></td>');
       $tr.data('nexusGroupName', nexusGroupName);

       $tdnexusGroupName.append(nexusGroupName);
       var $tdAction = $('<td/>');
       $tdAction.append('<div class="btn-group"><button class="deleteRow" value="Remove" title="Remove"><i class="ace-icon fa fa-trash-o bigger-120"></i></button></div>');

       $tdAction.find('.deleteRow').click(function() {
         $nexusGroupDetails.row($tr).remove().draw(true);
       });

       $tr.append($tdnexusGroupName).append($tdAction);
       $nexusGroupTbody.append($tr);
       $nexusGroupDetails.row.add($tr).draw();
       $("#nexusGroupDetailsModal").modal('hide');
     }
   });
   $("#savecreateNexusServerBtn").click(function(e) {
     var nexusGroupList = [];
     var tableData = $nexusGroupDetails.data();
     for (var i = 0; i < tableData.length; i++) {
       nexusGroupList.push(tableData[i][0]);
     }
     $('#groupid').val(JSON.stringify(nexusGroupList));
   });
   if (!$.fn.dataTable.isDataTable('#tablenexusGroupDetails')) {
     $nexusGroupDetails = $('#tablenexusGroupDetails').DataTable({
       "pagingType": "full_numbers",
       "iDisplayLength": 5,
       "aLengthMenu": [
         [5, 40, 100, -1],
         [5, 40, 100, "All"]
       ],
       "aoColumns": [{
         "bSortable": true
       }, {
         "bSortable": true
       }]
     });
   }
   $("#tablenexusGroupDetails_length").hide();
   $("#tablenexusGroupDetails_filter").hide();
   $("#nexusservername").focus();
   //form validation for dashboard save
  


$('#myForm101').submit(function(e) {
  
  var nexusDesc = [];
  var nexusData = {};
  
    var $form = $('#myForm101');
    nexusData.username = $form.find('#username').val();
    nexusData.nexuspassword = $form.find('#nexuspassword').val();
    nexusData.hostname = $form.find('#hostname').val();
    var reqBody = {
      nexusDesc: [nexusData]
    }
    var url = '../nexus/authenticate'
    var reqBody = {
      "username": nexusData.username,
      "nexuspassword": nexusData.nexuspassword,
      "hostname": nexusData.hostname
    };

    $.ajax({
      method: "POST",
      url: url,
      data: reqBody,
      success: function(data, success) {
        if (!data.length) {
          bootbox.alert('Invalid Nexus Server Details.');
        } else {
          if (validateForm()) {
            saveform('26');
          };
          $('.content').load('ajax/Settings/dockerWizard.html');
          return false; // for demo
        }
      },
      error: function(jqxhr) {
        $('.btn-2 a').parent('.bwizard-steps li').removeClass('active').addClass('green-btn');
        $('.contentSetting').find('ol li#dockerCreate').addClass('active');
        $('.content').load('ajax/Settings/dockerWizard.html');
        return false;
        bootbox.alert(jqxhr.responseText);
      },
      failure: function(jqxhr) {
        bootbox.alert(jqxhr.responseText);
      }
    });
  
  return false;
});
    //jQuery time
    var current_fs, next_fs, previous_fs; //fieldsets
    var left, opacity, scale; //fieldset properties which we will animate
    var animating; //flag to prevent quick multi-click glitches
    $(".nextChef").click(function(){
        $('.btn-2 a').parent('.bwizard-steps li').removeClass('active').addClass('green-btn');
        $('.contentSetting').find('ol li#dockerCreate').addClass('active');
        if(animating) return false;
        animating = true;

        current_fs = $(this).parent();
        next_fs = $(this).parent().next();

        //activate next step on progressbar using the index of next_fs
        $("#progressbar li").eq($("div form").index(next_fs)).addClass("active");
        //show the next fieldset
        next_fs.show();
        //hide the current fieldset with style
        current_fs.animate({opacity: 0}, {
            step: function(now, mx) {
                //as the opacity of current_fs reduces to 0 - stored in "now"
                //1. scale current_fs down to 80%
                scale = 1 - (1 - now) * 0.2;
                //2. bring next_fs from the right(50%)
                left = (now * 50)+"%";
                //3. increase opacity of next_fs to 1 as it moves in
                opacity = 1 - now;
                current_fs.css({'transform': 'scale('+scale+')'});
                next_fs.css({'left': left, 'opacity': opacity});
            },
            duration: 800,
            complete: function(){
                current_fs.hide();
                animating = false;
            },
            //this comes from the custom easing plugin
            easing: 'easeInOutBack'
        });
    });

    $(".previous").click(function(){
        if(animating) return false;
        animating = true;

        current_fs = $(this).parent();
        previous_fs = $(this).parent().prev();

        //de-activate current step on progressbar
        $("#progressbar li").eq($("form").index(current_fs)).removeClass("active");

        //show the previous fieldset
        previous_fs.show();
        //hide the current fieldset with style
        current_fs.animate({opacity: 0}, {
            step: function(now, mx) {
                //as the opacity of current_fs reduces to 0 - stored in "now"
                //1. scale previous_fs from 80% to 100%
                scale = 0.8 + (1 - now) * 0.2;
                //2. take current_fs to the right(50%) - from 0%
                left = ((1-now) * 50)+"%";
                //3. increase opacity of previous_fs to 1 as it moves in
                opacity = 1 - now;
                current_fs.css({'left': left});
                previous_fs.css({'transform': 'scale('+scale+')', 'opacity': opacity});
            },
            duration: 800,
            complete: function(){
                current_fs.hide();
                animating = false;
            },
            //this comes from the custom easing plugin
            easing: 'easeInOutBack'
        });
    });
</script>